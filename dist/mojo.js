var mojo={version:"1.1.4",evaluateClassPath:function(E){var D=E.split(".");var B=window;for(var A=D.length,C=0;C<A;C++){if(B){B=B[D[C]]}}return B}};dojo.provide("mojo.command.Behavior");dojo.declare("mojo.command.Behavior",null,{_requestObj:null,getRequest:function(){if(!this._requestObj){throw new Error("ERROR mojo.command.Behavior.getRequest - requestObj is not set")}return this._requestObj},_execute:function(B){this._requestObj=B;if(typeof (B.update)=="function"){B.update()}if(this._requestObj==null||(!this._requestObj)){throw new Error("ERROR mojo.command.Behavior._execute - requestObj is not set")}else{if(!(this._requestObj instanceof mojo.controller.Request)){throw new Error("ERROR mojo.command.Behavior._execute - requestObj is not type of mojo.controller.Request")}else{if(!this._requestObj.callerObj){throw new Error("ERROR mojo.command.Behavior._execute - callerObj is not set")}}}if(!B.getParams()&&typeof (B.getParams())=="boolean"){return }if(dojo.config&&dojo.config.isDebug){try{return this.execute(B)}catch(A){console.debug("EXCEPTION: "+A.message+" in mojo.command.Behavior.execute() for behavior: "+B.getCommandName()+", controller: "+B.getControllerName())}}else{return this.execute(B)}},execute:function(A){throw new Error("ERROR mojo.command.Behavior.execute - execute() method is not implemented")}});dojo.provide("mojo.command.Command");dojo.declare("mojo.command.Command",null,{_requestObj:null,getRequest:function(){if(!this._requestObj){throw new Error("ERROR mojo.command.Command.getRequest - requestObj is not set")}return this._requestObj},_execute:function(B){this._requestObj=B;if(typeof (B.update)=="function"){B.update()}if(this._requestObj==null||(!this._requestObj)){throw new Error("ERROR mojo.command.Command._execute - requestObj is not set")}else{if(!(this._requestObj instanceof mojo.controller.Request)){throw new Error("ERROR mojo.command.Command._execute - requestObj is not type of mojo.controller.Request")}}if(!B.getParams()&&typeof (B.getParams())=="boolean"){return }if(dojo.config&&dojo.config.isDebug){try{return this.execute(B)}catch(A){console.debug("EXCEPTION: "+A.message+" in mojo.command.Command.execute() for command: "+B.getCommandName()+", controller: "+B.getControllerName())}}else{return this.execute(B)}},execute:function(A){throw new Error("ERROR mojo.command.Command.execute - execute() method is not implemented")},onResponse:function(A){throw new Error("ERROR mojo.command.Command.onResponse - onResponse() method is not implemented")},onError:function(A){throw new Error("ERROR mojo.command.Command.onError - onError() method is not implemented")}});dojo.provide("mojo.command.Rule");dojo.declare("mojo.command.Rule",null,{_requestObj:null,getRequest:function(){if(!this._requestObj){throw new Error("ERROR mojo.command.Rule.getRequest -requestObj is not set")}return this._requestObj},_execute:function(B){this._requestObj=B;if(typeof (B.update)=="function"){B.update()}if(this._requestObj==null||(!this._requestObj)){throw new Error("ERROR mojo.command.Rule._execute - requestObj is not set")}else{if(!(this._requestObj instanceof mojo.controller.Request)){throw new Error("ERROR mojo.command.Rule._execute - requestObj is not type of mojo.controller.Request")}else{if(!this._requestObj.callerObj){throw new Error("ERROR mojo.command.Rule._execute - callerObj is not set")}else{if(!this._requestObj.invocation){throw new Error("ERROR mojo.command.Rule._execute - invocation is not set")}}}}if(dojo.config&&dojo.config.isDebug){try{if(this.execute(B)){return true}return false}catch(A){console.debug("EXCEPTION: "+A.message+" in mojo.command.Rule.execute() for rule: "+B.getCommandName()+", controller: "+B.getControllerName())}}else{if(this.execute(B)){return true}return false}try{}catch(A){}},execute:function(A){if(this.condition(A)){return A.invocation.proceed()}},condition:function(A){throw new Error("ERROR mojo.command.Rule.condition - condition() method is not implemented")}});dojo.provide("mojo.controller.Controller");dojo.declare("mojo.controller.Controller",null,{constructor:function(A,B){this._init(A,B);dojo.addOnUnload(dojo.hitch(this,this._mojoCleanup))},_mojoCleanup:function(){this.removeObservers();this.contextElementObj=null},_contextElementObj:null,_commands:new Array(),_connectHandles:new Array(),_queryCache:new Object(),_observers:new Object(),_tags:new Array(),_init:function(A,E){if(this.params){var D={};D.onChange=function(){};var F=this._getBaseProperty("params");for(var B in F){if(typeof F[B]=="object"){var C=F[B];D[B]=new mojo.controller.Param(B,dojo.clone(C.defaultValue),C.required,C.type,D);if(E){D[B].setValue(E[B])}}}for(var B in this.params){if(typeof this.params[B]=="object"){var C=this.params[B];D[B]=new mojo.controller.Param(B,dojo.clone(C.defaultValue),C.required,C.type,D);if(E){D[B].setValue(E[B])}}}this.params=D;D=null;E=null}this._contextElementObj=null;if(A){this._contextElementObj=A}this._commands=new Array();this._tags=new Array();this._connectHandles=new Array();this._callBaseMethod("addCommands");this.addCommands();this._addObservers();this._callBaseMethod("addIntercepts");this.addIntercepts();this.onInit();if(this.params){for(var B in this.params){if(typeof this.params[B]=="object"){var C=this.params[B];if(C.getValue()!=null){C.onChange()}}}}mojo.Messaging.subscribe("/mojo/controller/"+this.declaredClass+"/addObservers",this,"_addObservers");mojo.Messaging.subscribe("/mojo/controller/addObservers",this,"_addObservers")},getConfig:function(A){A=A.toLowerCase();switch(A){case"params":return this[A];break}return null},getValue:function(A){return this.params[A].getValue()},setValue:function(B,A){this.params[B].setValue(A)},getContextController:function(A){if(this.getContextElement()&&this.getContextElement().mojoControllers[A]){return this.getContextElement().mojoControllers[A]}return null},_getBaseProperty:function(B){var A=mojo.evaluateClassPath(this.declaredClass);var C=A.superclass;if(C.declaredClass!="mojo.controller.Controller"&&C[B]){return C[B]}return null},_callBaseMethod:function(A){var B=this._getBaseProperty(A);if(B){B.call(this)}},getContextElement:function(){if(!this._contextElementObj){return null}return this._contextElementObj},onInit:function(){},_addObservers:function(){this._queryCache=new Object();this._observers=new Object();this._callBaseMethod("addObservers");this.addObservers();for(var B in this._queryCache){if(this._queryCache[B]["length"]){for(var D in this._observers[B]){if(this._observers[B][D]["length"]){var C=this._queryCache[B].length;for(var A=0;A<C;A++){this._addObserver(this._queryCache[B][A],D,this._observers[B][D])}}}}}this._queryCache=new Object();this._observers=new Object()},addObservers:function(){throw new Error("ERROR mojo.controller.Controller.addObservers - addObservers() method is not implemented")},removeObservers:function(){var A=this._connectHandles.length;for(var B=0;B<A;B++){dojo.disconnect(this._connectHandles[B])}},addObserver:function(I,E,H,F){var A=function(K){if(!dojo.isArray(K)){return false}for(var L=0,J=K.length;L<J;L++){if(typeof (K[L])!="string"){return false}}return true};if(!I){return }if(!E){throw new Error("ERROR mojo.controller.Controller.addObserver - srcFunc is not set")}if(typeof (E)!="string"){throw new Error("ERROR mojo.controller.Controller.addObserver - srcFunc is not type String")}if(!H){throw new Error("ERROR mojo.controller.Controller.addObserver - cmdName is not set")}if(typeof (H)!="string"&&H!=null){throw new Error("ERROR mojo.controller.Controller.addObserver - cmdName is not type String")}if(typeof (I)=="string"||A(I)){if(!dojo.isArray(I)){I=[I]}for(var D=0,G=I.length;D<G;D++){var C=I[D];if(this.getContextElement()&&E.match(/^onclick|onmouse|onkey|onmove/)!=null){this._addObserver(this.getContextElement(),E,[{cmdName:H,paramsObj:F,eventDelegate:C}])}else{if(!this._queryCache[C]){this._queryCache[C]=mojo.query(C,this.getContextElement())}if(!this._observers[C]){this._observers[C]=new Object()}if(!this._observers[C][E]){this._observers[C][E]=new Array()}var B=this._observers[C][E].length;this._observers[C][E][B]={cmdName:H,paramsObj:F}}}}else{if(!dojo.isArray(I)){I=[I]}for(var D=0,G=I.length;D<G;D++){this._addObserver(I[D],E,[{cmdName:H,paramsObj:F}])}}if(!(this._commands[H])||this._commands[H]==null){throw new Error("ERROR mojo.controller.Controller.addObserver - cmdName does not reference a Command in the Controller")}},_addObserver:function(I,D,A){mojo.controller.Map.getInstance()._mojoRefs.push(I);var B=new Array();var E=A.length;for(var C=0;C<E;C++){if(typeof (A[C].eventDelegate)=="undefined"){A[C].eventDelegate=""}if(!this._observerIsTagged(I,D+A[C].eventDelegate,A[C])){B.push(A[C]);this._tagObserver(I,D+A[C].eventDelegate,A[C])}}if(!I.mojoObservers){I.mojoObservers=new Object()}if(!I.mojoObservers[D]){I.mojoObservers[D.toLowerCase()]=new Array()}if(B.length>0){var H=this;var G=function(N){var M=function(R){var R=R||window.event;var Q=R.target||R.srcElement;if(Q.nodeType==3){Q=Q.parentNode}return Q};if(H.getContextElement()&&H.getContextElement().parentNode==null){H.removeObservers()}else{var O=B.length;for(var K=0;K<O;K++){if(typeof (mojo)!="undefined"){var J=I;if(B[K].eventDelegate.length>0){var L=M(N);J=mojo.queryMatch(L,B[K].eventDelegate,H.getContextElement(),true)}if(J!=null){var P=H._setRequest(B[K].paramsObj,J,N,B[K].cmdName);H.fireCommandChain(B[K].cmdName,P)}}}}};var F=dojo.connect(I,D,G);this._connectHandles.push(F);I.mojoObservers[D.toLowerCase()].push(G)}},_tagObserver:function(A,E,D){if(!A.mojoObserve){A.mojoObserve=new Object()}if(typeof A.mojoObserve[this.declaredClass]=="undefined"){var F=this._tags.length;A.mojoObserve[this.declaredClass]=F;this._tags[F]=new Object()}var C=A.mojoObserve[this.declaredClass];var B=this._generateTagKey(E,D);if(this._tags[C]&&!this._tags[C][B]){this._tags[C][B]=true}},_generateTagKey:function(D,C){var B=D+"_"+C.cmdName;if(C.paramsObj){var E;if(typeof (C.paramsObj)=="function"){E=C.paramsObj.toString()}else{if(typeof (C.paramsObj)=="object"){for(var A in C.paramsObj){if(C.paramsObj[A]){E+=A+":"+C.paramsObj[A].toString()+","}}}}B+="_"+E}return B},_observerIsTagged:function(A,D,C){if(!A.mojoObserve){A.mojoObserve=new Object()}var E=false;var B=this._generateTagKey(D,C);if(typeof A.mojoObserve[this.declaredClass]!="undefined"&&this._tags[A.mojoObserve[this.declaredClass]]&&this._tags[A.mojoObserve[this.declaredClass]][B]){E=true}return E},addCommands:function(){throw new Error("ERROR mojo.controller.Controller.addCommands - addCommands() method is not implemented")},addCommand:function(B,A){if(!B){throw new Error("ERROR mojo.controller.Controller.addCommand - cmdName is not set")}if(typeof (B)!="string"){throw new Error("ERROR mojo.controller.Controller.addCommand - cmdName is not type String")}if(!A){throw new Error("ERROR mojo.controller.Controller.addCommand - cmdObjPath is not set")}if(typeof (A)!="string"){throw new Error("ERROR mojo.controller.Controller.addCommand - cmdObjPath is not type String")}if(!this._commands[B]){this._commands[B]=new Array()}var C=function(F,D,H){dojo.require(D);var E=mojo.evaluateClassPath(D);var G=new E();if((G instanceof mojo.command.Command)||(G instanceof mojo.command.Rule)||(G instanceof mojo.command.Behavior)){H._commands[F].push(G)}else{throw new Error("ERROR mojo.controller.Controller.addCommand - Command object is not type mojo.command.Command or mojo.command.Behavior or mojo.command.Rule")}};C(B,A,this)},getCommand:function(A){if(!A){throw new Error("ERROR mojo.controller.Controller.getCommand - cmdName is not set")}if(typeof (A)!="string"){throw new Error("ERROR mojo.controller.Controller.getCommand - cmdName is not type String")}if(this._commands[A]){return this._commands[A][0]}throw new Error("ERROR mojo.controller.Controller.getCommand - cmdName does not reference a Command in the Controller")},getCommandChain:function(A){if(!A){throw new Error("ERROR mojo.controller.Controller.getCommandChain - cmdName is not set")}if(typeof (A)!="string"){throw new Error("ERROR mojo.controller.Controller.getCommandChain - cmdName is not type String")}if(!this._commands[A]){throw new Error("ERROR mojo.controller.Controller.getCommandChain - cmdName does not reference a Command in the Controller")}if(this._commands[A]){return this._commands[A]}return null},fireCommandChain:function(A,D){var C=this._commands[A].length;for(var B=0;B<C;B++){this._commands[A][B]._execute(D)}},addIntercepts:function(){throw new Error("ERROR mojo.controller.Controller.addIntercepts - addIntercepts() method is not implemented")},addIntercept:function(G,F,B,E){if(!G){throw new Error("ERROR mojo.controller.Controller.addIntercept - interceptType is not set")}if(typeof (G)!="string"){throw new Error("ERROR mojo.controller.Controller.addIntercept - interceptType is not type String")}if(G=="before"||G=="after"||G=="around"){}else{throw new Error('ERROR mojo.controller.Controller.addIntercept - interceptType is not "before", "after", or "around"')}if(!F){throw new Error("ERROR mojo.controller.Controller.addIntercept - interceptCmdName is not set")}if(typeof (F)!="string"){throw new Error("ERROR mojo.controller.Controller.addIntercept - interceptCmdName is not type String")}if(!B){throw new Error("ERROR mojo.controller.Controller.addIntercept - cmdName is not set")}if(typeof (B)!="string"){throw new Error("ERROR mojo.controller.Controller.addIntercept - cmdName is not type String")}if(F.toString()==B.toString()){throw new Error("ERROR mojo.controller.Controller.addIntercept - a command cannot add advice to itself")}if(!this._commands[F]){throw new Error("ERROR mojo.controller.Controller.addIntercept - interceptCmdName does not reference a Command in the Controller")}if(!this._commands[B]){throw new Error("ERROR mojo.controller.Controller.addIntercept - cmdName does not reference a Command in the Controller")}var C=this;var D=this.getCommand(F)["_execute"];var A=function(H){if(typeof (mojo)!="undefined"){requestObj=C._setRequest(E,H.args[0].callerObj,H.args[0].eventObj,B,H);C.fireCommandChain(B,requestObj)}};switch(G){case"before":this._commands[F][0]["_execute"]=function(){var H={args:arguments,calleeObj:this};A.apply(this,[H]);return D.apply(this,arguments)};break;case"after":this._commands[F][0]["_execute"]=function(){var H={args:arguments,calleeObj:this};D.apply(this,arguments);return A.apply(this,[H])};break;case"around":this._commands[F][0]["_execute"]=function(){var H={args:arguments,calleeObj:this};H.proceed=function(){return D.apply(this.calleeObj,this.args)};return A.apply(this,[H])};break}},_setRequest:function(E,A,C,B,D){var F=new mojo.controller.Request(E,A,C,B,this,D);return F}});mojo.controller.Controller.updateObservers=function(A){if(A){mojo.Messaging.publish("/mojo/controller/"+A+"/addObservers")}else{mojo.Messaging.publish("/mojo/controller/addObservers")}};dojo.provide("mojo.controller.Map");__mojoControllerMap=null;dojo.declare("mojo.controller.Map",null,{onComplete:function(){},constructor:function(){mojo.Messaging.subscribe("/mojo/controller/mapControllers",this,"mapControllers");dojo.addOnUnload(dojo.hitch(this,this._mojoCleanup))},_controllers:new Array(),_siteMap:null,getSiteMap:function(){if(!this._siteMap){throw new Error("ERROR mojo.controller.Map - siteMap not set")}return this._siteMap},setSiteMap:function(F){if(F==null||typeof F=="undefined"){throw new Error("ERROR mojo.controller.Map.setSiteMap - siteMapObj parameter is required")}var B=function(){throw new Error('ERROR mojo.controller.Map.setSiteMap - siteMapObj parameter must consist of patterns in the format {pattern: "pattern", controllers: [{controller: "controller.path"}]}')};if(!dojo.isArray(F)){B()}for(var D=0,A=F.length;D<A;D++){var E=F[D];if(typeof E.pattern=="undefined"||E.pattern==null){B()}if(!dojo.isArray(E.controllers)){B()}for(var C=0,A=E.controllers.length;C<A;C++){if(typeof E.controllers[C].controller=="undefined"||!dojo.isString(E.controllers[C].controller)||E.controllers[C].controller==""){B()}}}for(pattern in F){}this._siteMap=F},mapControllers:function(C){var B=this.getSiteMap();var I=B.length;for(var E=0;E<I;E++){var G=B[E].pattern;if(typeof (G)=="string"){var A=[];if(C&&typeof (C)=="object"){A=mojo.query(G,C)}else{A=mojo.query(G)}var F=A.length;for(var D=0;D<F;D++){this._mapControllers(B[E].controllers,A[D])}}else{if(typeof (G)=="function"||typeof (G)=="object"){if(C&&typeof (C)=="string"){var H=new RegExp(G);if(H.test(C)){this._mapControllers(B[E].controllers)}}}else{alert(G);throw new Error("ERROR mojo.controller.Map - siteMap contains invalid pattern")}}}this.onComplete()},_mojoRefs:[],_mojoCleanup:function(){this._mojoRefs.push(document);this._mojoRefs.push(document.body);this._mojoRefs.push(document.documentElement);document.head=document.extend=document.getElementsBySelector=null;for(var B=0;B<this._mojoRefs.length;B++){var C=this._mojoRefs[B];if(!C){continue}if(C.mojoObservers){for(var A in C.mojoObservers){C[A]=null}}C.mojoControllers=C.mojoObservers=C.mojoObserve=null}},_mapControllers:function(F,A){var B=F.length;for(var D=0;D<B;D++){var E=F[D].controller;var G=F[D].params;if(dojo.config&&dojo.config.isDebug){try{this.mapController(E,A,G)}catch(C){console.debug("EXCEPTION: "+C.message+" in mojo.controller.Map.mapController() for controller: "+E)}}else{this.mapController(E,A,G)}}},mapController:function(C,A,D){if(C==null||typeof C=="undefined"){throw new Error("ERROR mojo.controller.Map.mapController - controllerName parameter is required")}if(!dojo.isString(C)||C==""){throw new Error("ERROR mojo.controller.Map.mapController - controllerName parameter must be a non-empty string")}dojo.require(C);var B=mojo.evaluateClassPath(C);if(A){if(!A.mojoControllers){A.mojoControllers={}}if(!A.mojoControllers[C]){A.mojoControllers[C]=new B(A,D);if(!(A.mojoControllers[C] instanceof mojo.controller.Controller)){throw new Error('ERROR mojo.controller.Map.mapController - "'+C+'" must be an instance of mojo.controller.Controller')}}}else{if(!this._controllers[C]){this._controllers[C]=new B(null,D);if(!(this._controllers[C] instanceof mojo.controller.Controller)){throw new Error('ERROR mojo.controller.Map.mapController - "'+C+'" must be an instance of mojo.controller.Controller')}}}}});mojo.controller.Map.mapControllers=function(A){mojo.Messaging.publish("/mojo/controller/mapControllers",[A])};mojo.controller.Map.getInstance=function(){if(__mojoControllerMap==null){__mojoControllerMap=new mojo.controller.Map()}return __mojoControllerMap};dojo.provide("mojo.controller.Param");dojo.declare("mojo.controller.Param",null,{constructor:function(C,A,E,D,B){this._value=null;this._defaultValue=null;this._params=null;this._type=null;this._name=C;this._defaultValue=A;if(D){this._type=D}if(B){this._params=B}this.setValue(this._defaultValue);if(typeof E=="boolean"){this._required=E}},_name:null,_value:null,_defaultValue:null,_required:false,_type:null,_params:null,getName:function(){return this._name},getValue:function(){return this._value},setValue:function(C,B){var E=mojo.helper.Validation.getInstance();var D=this.getRequired();var A=this.getType();if(D&&!E.isRequired(C)){throw new Error("ERROR mojo.controller.Param.setValue - value parameter is required")}if(typeof C=="undefined"){return }if(A&&!E.isType(C,{type:A})){throw new Error("RROR mojo.controller.Param.setValue - value parameter is invalid type")}if(this.getValue()!=C){this._value=C;if(!B){this.onChange();if(this._params!=null&&this._params["onChange"]){this._params.onChange()}}}},getDefaultValue:function(){return this._defaultValue},getRequired:function(){return this._required},getType:function(){return this._type},onChange:function(){}});dojo.provide("mojo.controller.Request");dojo.declare("mojo.controller.Request",null,{constructor:function(F,A,D,B,C,E){this._paramsFunc=null;this.paramsObj=null;this.callerObj=null;this.eventObj=null;this.commandName=null;this.controllerObj=null;this.invocation=null;if(typeof (F)=="function"){this.paramsObj={};this._paramsFunc=F}else{if(typeof (F)=="object"){this.paramsObj=F}}if(A==null||typeof A=="undefined"){throw new Error("ERROR mojo.controller.Request.constructor - callerObj is not set")}else{this.callerObj=A}this.eventObj=D;if(B==null||typeof B=="undefined"){throw new Error("ERROR mojo.controller.Request.constructor - commandName is not set")}else{if(typeof B!="string"){throw new Error("ERROR mojo.controller.Request.constructor - commandName is not type String")}else{this.commandName=B}}if(C==null||typeof C=="undefined"){throw new Error("ERROR mojo.controller.Request.constructor - controllerObj is not set")}else{if(!(C instanceof mojo.controller.Controller)){throw new Error("ERROR mojo.controller.Request.constructor - controllerObj is not type mojo.controller.Controller")}else{this.controllerObj=C}}this.invocation=E},_paramsFunc:null,paramsObj:null,callerObj:null,eventObj:null,commandName:null,controllerObj:null,invocation:null,update:function(){if(this._paramsFunc&&typeof (this._paramsFunc)=="function"){var A=this._paramsFunc(this.getContextElement(),this.getCaller(),this.getController());for(var B in A){this.paramsObj[B]=A[B]}}},getParams:function(){if(!this.paramsObj){this.update()}return this.paramsObj},getCaller:function(){return this.callerObj},getContextElement:function(){return this.getController().getContextElement()},getEvent:function(){return this.eventObj},getCommandName:function(){return this.commandName},getController:function(){return this.controllerObj},getControllerName:function(){return this.getController().declaredClass},getInvocation:function(){return this.invocation}});dojo.provide("mojo.helper.Inflector");var __mojoInflector=null;dojo.declare("mojo.helper.Inflector",null,{Inflections:{plural:[[/(quiz)$/i,"$1zes"],[/^(ox)$/i,"$1en"],[/([m|l])ouse$/i,"$1ice"],[/(matr|vert|ind)ix$|ex$/i,"$1ices"],[/(x|ch|ss|sh)$/i,"$1es"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/(hive)$/i,"$1s"],[/(?:([^f])fe|([lr])f)$/i,"$1$2ves"],[/sis$/i,"ses"],[/([ti])um$/i,"$1a"],[/(buffal|tomat)o$/i,"$1oes"],[/(bu)s$/i,"$1ses"],[/(alias|status)$/i,"$1es"],[/(octop|vir)us$/i,"$1i"],[/(ax|test)is$/i,"$1es"],[/s$/i,"s"],[/$/,"s"]],singular:[[/(quiz)zes$/i,"$1"],[/(matr)ices$/i,"$1ix"],[/(vert|ind)ices$/i,"$1ex"],[/^(ox)en/i,"$1"],[/(alias|status)es$/i,"$1"],[/(octop|vir)i$/i,"$1us"],[/(cris|ax|test)es$/i,"$1is"],[/(shoe)s$/i,"$1"],[/(o)es$/i,"$1"],[/(bus)es$/i,"$1"],[/([m|l])ice$/i,"$1ouse"],[/(x|ch|ss|sh)es$/i,"$1"],[/(m)ovies$/i,"$1ovie"],[/(s)eries$/i,"$1eries"],[/([^aeiouy]|qu)ies$/i,"$1y"],[/([lr])ves$/i,"$1f"],[/(tive)s$/i,"$1"],[/(hive)s$/i,"$1"],[/([^f])ves$/i,"$1fe"],[/(^analy)ses$/i,"$1sis"],[/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$/i,"$1$2sis"],[/([ti])a$/i,"$1um"],[/(n)ews$/i,"$1ews"],[/s$/i,""]],irregular:[["move","moves"],["sex","sexes"],["child","children"],["man","men"],["person","people"],["cow","kine"]],uncountable:["sheep","fish","series","species","money","rice","information","equipment"]},ordinalize:function(A){if(11<=parseInt(A)%100&&parseInt(A)%100<=13){return A+"th"}else{switch(parseInt(A)%10){case 1:return A+"st";case 2:return A+"nd";case 3:return A+"rd";default:return A+"th"}}},pluralize:function(G){for(var C=0;C<this.Inflections.uncountable.length;C++){var B=this.Inflections.uncountable[C];if(G.toLowerCase()==B){return B}}for(var C=0;C<this.Inflections.irregular.length;C++){var D=this.Inflections.irregular[C][0];var A=this.Inflections.irregular[C][1];var F=new RegExp(D+"$");if(F.test(G.toLowerCase())||G==A){return G.replace(F,A)}}for(var C=0;C<this.Inflections.plural.length;C++){var E=this.Inflections.plural[C][0];var H=this.Inflections.plural[C][1];if(E.test(G)){return G.replace(E,H)}}},singularize:function(G){for(var C=0;C<this.Inflections.uncountable.length;C++){var B=this.Inflections.uncountable[C];if(G.toLowerCase==B){return B}}for(var C=0;C<this.Inflections.irregular.length;C++){var D=this.Inflections.irregular[C][0];var A=this.Inflections.irregular[C][1];var F=new RegExp(A+"$");if((F.test(G.toLowerCase()))||(G==A)){return G.replace(F,D)}}for(var C=0;C<this.Inflections.singular.length;C++){var E=this.Inflections.singular[C][0];var H=this.Inflections.singular[C][1];if(E.test(G)){return G.replace(E,H)}}return G}});mojo.helper.Inflector.pluralize=function(A){var B=mojo.helper.Inflector.getInstance();return B.pluralize(A)};mojo.helper.Inflector.singularize=function(A){var B=mojo.helper.Inflector.getInstance();return B.singularize(A)};mojo.helper.Inflector.ordinalize=function(A){var B=mojo.helper.Inflector.getInstance();return B.ordinalize(A)};mojo.helper.Inflector.getInstance=function(){if(__mojoInflector==null){__mojoInflector=new mojo.helper.Inflector()}return __mojoInflector};dojo.provide("mojo.helper.Validation");var __mojoHelperValidation=null;dojo.declare("mojo.helper.Validation",null,{isRequired:function(A){if(typeof A=="undefined"||A==null){return false}if(dojo.isString(A)){return dojo.string.trim(A).length>0}return true},isType:function(A,B){switch(B.type){case String:return(typeof A=="string"||A instanceof String);break;case Number:return(typeof A=="number"||A instanceof Number);break;case Boolean:return(typeof A=="boolean"||A instanceof Boolean);break;default:return(A instanceof B.type)}},isEmailAddress:function(A){if(A==null){throw new Error("ERROR mojo.helper.Validation.isEmailAddress - value parameter is required")}if(!dojo.isString(A)){throw new Error("ERROR mojo.helper.Validation.isEmailAddress - value parameter must be a non-empty string")}A=A.replace(/^\s+|\s+$/g,"");dojo.require("dojox.validate");dojo.require("dojox.validate.web");if(!dojox.validate.isEmailAddress(A,{})||A.match(/[^\w-_@\.]/gi)){return false}return true},isEmailAddressList:function(A){if(A==null){throw new Error("ERROR mojo.helper.Validation.isEmailAddressList - value parameter is required")}if(!dojo.isString(A)){throw new Error("ERROR mojo.helper.Validation.isEmailAddressList - value parameter must be a non-empty string")}dojo.require("dojox.validate");dojo.require("dojox.validate.web");if(!dojox.validate.isEmailAddressList(A,{})){return false}return true},isUrl:function(A){if(A==null){throw new Error("ERROR mojo.helper.Validation.isUrl - value parameter is required")}if(!dojo.isString(A)){throw new Error("ERROR mojo.helper.Validation.isUrl - value parameter must be a non-empty string")}dojo.require("dojox.validate");dojo.require("dojox.validate.web");return dojox.validate.isUrl(A,{allowLocal:true})},isLength:function(A,B){if((A==null)||(A=="")){return true}if(!dojo.isString(A)){throw new Error("ERROR mojo.helper.Validation.isLength - value parameter must be a string")}if(B){if(B.min&&B.min>A.length){return false}if(B.max&&B.max<A.length){return false}}return true},isRange:function(A,B){if((A==null)||(A=="")){return true}A=parseInt(A);if(isNaN(A)){return false}if(B){if(typeof (B.min)=="undefined"){B.min=0}if(B.min>A){return false}if(typeof (B.max)!="undefined"&&B.max<A){return false}}return true},isMatch:function(A,B){if((A==null)||(A=="")){return true}if(B){if(B.refValue){B.regex="^"+B.refValue+"$"}if(!(new RegExp(B.regex)).test(A)){return false}}return true},isZipCode:function(D){var B="0123456789-";var C=0;if((D==null)||(D=="")){return true}if(D.length!=5&&D.length!=10){return false}for(var A=0;A<D.length;A++){temp=""+D.substring(A,A+1);if(temp=="-"){C++}if(B.indexOf(temp)=="-1"){return false}if((C>1)||((D.length==10)&&""+D.charAt(5)!="-")){return false}}return true},isPostalCode:function(A){if(A==null){throw new Error("ERROR mojo.helper.Validation.isPostalCode - value parameter is required")}if(!dojo.isString(A)){throw new Error("ERROR mojo.helper.Validation.isPostalCode - value parameter must be a non-empty string")}if(typeof A=="undefined"||A==null){return false}if(A.length==6&&A.search(/^[a-zA-Z]\d[a-zA-Z]\d[a-zA-Z]\d$/)!=-1){return true}else{if(A.length==7&&A.search(/^[a-zA-Z]\d[a-zA-Z](-|\s)\d[a-zA-Z]\d$/)!=-1){return true}else{return false}}return true},execute:function(I,T){if(typeof I=="undefined"||I==null){throw new Error("ERROR mojo.helper.Validation.execute - rulesObj parameter is required")}if(typeof T=="undefined"||T==null){throw new Error("ERROR mojo.helper.Validation.execute - domElmListObj parameter is required")}var S=function(){throw new Error('ERROR mojo.helper.Validation.execute - rulesObj parameter must consist of rules in the format {"inputName": [{rule: testFunction[, errorMsg: "msg"]}[, ...]]}')};if(!dojo.isArray(T)){T=[T]}for(rule in I){if(!dojo.isArray(I[rule])){S()}for(var P=0,Q=I[rule].length;P<Q;P++){if(typeof I[rule][P].rule!="function"){S()}if(typeof I[rule][P].error!="undefined"&&!dojo.isString(I[rule][P].error)){S()}}}var F=function(b,a){if(!b){return null}do{b=b.nextSibling}while(b&&b.nodeType!=1);if(b&&a&&a.toLowerCase()!=b.tagName.toLowerCase()){return F(b,a)}return b};var B=new Array();var D=T.length;for(var P=0;P<D;P++){var C=mojo.query("*[name]",T[P]);if(T[P].name){C.push(T[P])}var X=C.length;for(var O=0;O<X;O++){B.push(C[O])}B=mojo.distinct(B);var R=mojo.query(".mojoValidationError",T[P]);var U=F(T[P],"SPAN");if(U!=null&&dojo.hasClass(U,"mojoValidationError")){R.push(U)}var W=R.length;for(var O=0;O<W;O++){dojo._destroyElement(R[O])}}var N=true;var E=new Array();var J=function(b){var a=true;while(b!=null){if(dojo.style(b,"visibility")=="hidden"||dojo.style(b,"display")=="none"){a=false;break}b=(b.tagName=="BODY")?null:b.parentNode}return a};var L=B.length;var V={};for(var P=(L-1);P>=0;P--){var H=B[P];if(H.type=="radio"||H.type=="checkbox"){H.mojoValidationGroup=true;if(!V[H.name]){V[H.name]=new Array()}else{B[P]=null}if(H.checked){V[H.name].push((H.value)?H.value:"checked")}}}for(var P=0;P<L;P++){var H=B[P];if(H){if(I[H.name]){var Z=I[H.name];var G=Z.length;for(var O=0;O<G;O++){var A=Z[O];if(A["force"]||(J(H)&&!H.disabled)||(H.type&&H.type=="hidden")){if(A.params&&A.params.ref){var Y=mojo.queryFirst('*[name="'+A.params.ref+'"]').value;if(Y&&Y.length>0){A.params.refValue=Y}}var K=H.value;if(H.mojoValidationGroup){K=V[H.name].toString()}if(!(A.rule(K,A.params))){var M={element:H,message:A["errorMsg"]};E.push(M);N=false;break}}}}}}return E}});mojo.helper.Validation.getInstance=function(){if(__mojoHelperValidation==null){__mojoHelperValidation=new mojo.helper.Validation()}return __mojoHelperValidation};dojo.provide("mojo.helper.view.Error");mojo.helper.view.Error.showElementErrors=function(F,C){var A=F.length;for(var D=0;D<A;D++){var B=F[D];var E=document.createElement("span");E.className="mojoValidationError";E.innerHTML=B.message;if(C!=null){C.appendChild(E)}else{if(B.element.type=="checkbox"){if(B.element.parentNode.tagName=="LABEL"){dojo.place(E,B.element.parentNode,"after")}else{dojo.place(E,B.element,"after")}}else{dojo.place(E,B.element,"after")}}}};dojo.provide("mojo.helper.XML");dojo.declare("mojo.helper.XML",null,{constructor:function(A,C){if(typeof XMLDocument!="undefined"&&A instanceof XMLDocument){this.xmlDocument=A}else{if(A.readyState){this.xmlDocument=A}else{if(window.ActiveXObject){this.xmlDocument=new ActiveXObject("Microsoft.XMLDOM");this.xmlDocument.async="false";this.xmlDocument.loadXML(A)}else{if(document.implementation&&document.implementation.createDocument){var B=new DOMParser();this.xmlDocument=B.parseFromString(A,"text/xml")}else{throw new Error("ERROR mojo.helper.XML.constructor - This browser does not support XML parsing")}}}}this.params=new mojo.helper.XML.params();for(key in C){this.params[key]=C[key]}},toObject:function(){var B={};var A=this.xmlDocument.documentElement;var C=this._parseNode(A);B[A.nodeName]=C;return B},_parseNode:function(B){var C=null;var F=true;var I=false;if(B.nodeType==7){return }if(B.nodeType==3||B.nodeType==4){if(this._isWhiteSpace(B.nodeValue)){return }return B.nodeValue}if(B.attributes){var E=B.attributes.length;if(E){I=true;if(!C){C={}}for(var D=0;D<E;D++){C["@"+B.attributes[D].nodeName]=this._toJavaScriptType(B.attributes[D].nodeValue)}}}if(B.childNodes){var E=B.childNodes.length;if(E){if(!C){C={}}for(var D=0;D<E;D++){var A=B.childNodes[D].nodeType;F=(A==3&&!this._isWhiteSpace(B.childNodes[D].nodeValue))}if(F&&!I){for(var D=0;D<E;D++){if(D==0){C=this._nodeToString(B.childNodes[D])}else{C+=this._nodeToString(B.childNodes[D])}}}else{for(var D=0;D<E;D++){var H=this._parseNode(B.childNodes[D]);if(typeof H=="undefined"){continue}var G=B.childNodes[D].nodeName;if(G=="#cdata-section"){G="#cdata"}if(C[G]){if(!(C[G] instanceof Array)&&G!="#cdata"){C[G]=[C[G]]}if(G=="#cdata"){C[G]+=H}else{C[G].push(H)}}else{if(this._shouldInferArrays(B,C)){C[G]=[H]}else{C[G]=H}}}}}else{if(this._shouldInferArrays(B,C)){if(!C){C={}}C[mojo.helper.Inflector.singularize(B.nodeName)]=[]}}}return C},_shouldInferArrays:function(B,A){return(this.params.inferArrays&&((mojo.helper.Inflector.pluralize(mojo.helper.Inflector.singularize(B.nodeName))==B.nodeName)||(A&&Number(A["@total"]).toString()!="NaN")))},_isWhiteSpace:function(A){return !A.match(/[^\x00-\x20]/)},_nodeToString:function(F){var B=F.nodeType;var H=F.nodeName;switch(B){case 1:str="<"+H;if(F.attributes){var A=F.attributes.length;if(A){for(var E=0;E<A;E++){var D=F.attributes[E].nodeName;var G=F.attributes[E].nodeValue||"";str+=" "+D+'="'+G+'"'}}}if(F.childNodes){var A=F.childNodes.length;if(A){var C=true;str+=">";for(var E=0;E<A;E++){str+=this._nodeToString(F.childNodes[E])}}}if(C){str+="</"+H+">"}else{str+="/>"}break;case 3:str=this._toJavaScriptType(F.nodeValue);break;case 4:str="<![CDATA["+F.nodeValue+"]]>";break}return str},_toJavaScriptType:function(C){if(C.toLowerCase()=="false"){return false}if(C.toLowerCase()=="true"){return true}if(C.match("0[0-7]{3}")&&C.indexOf("-")<=0){var D=parseInt(C);return D}var E=parseFloat(C);if(E==C){return E}var B=parseInt(C);if(B==C){return B}if(C.match(/^[0-9]+[\- ][0-9]+[\- ][0-9]+/)){var A=new Date(C.replace(/[\- ]/g,"/"))}else{var A=new Date(C)}if(A instanceof Date&&A.toString()!="Invalid Date"&&A.toString()!="NaN"){return A}return C}});mojo.helper.XML.toObject=function(A,B){var A=new mojo.helper.XML(A,B);return A.toObject()};dojo.declare("mojo.helper.XML.params",null,{inferArrays:true});dojo.provide("mojo.History");var __mojoHistory=null;dojo.declare("mojo.History",null,{constructor:function(){var A=this;if(typeof rsh!="undefined"&&rsh["dhtmlHistory"]&&rsh["dhtmlHistory"]["_isIE"]){rsh.dhtmlHistory.init();dojo.connect(rsh.dhtmlHistory,"_fireHistoryEvent",function(B){A.setHash(B);A._execute()})}else{this._interval=window.setInterval(function(){A._execute()},100)}},_interval:null,_defaultHash:"",_savedHash:"",_paramsObj:null,_topic:null,onChange:function(){},getHash:function(){var A=window.location.hash;if(A.length>0){A=A.substring(1)}if(A.toLowerCase()=="null"||A.toLowerCase()=="undefined"){A=""}if(A.length==0&&this._defaultHash.length>0){A=this._defaultHash}return A},setHash:function(A){if(A==null||typeof A=="undefined"){throw new Error("ERROR mojo.History.setHash - newHash parameter is required")}if(!dojo.isString(A)||A==""){throw new Error("ERROR mojo.History.setHash - newHash parameter must be a non-empty string")}window.location.hash=A},setDefault:function(A){if(A==null||typeof A=="undefined"){throw new Error("ERROR mojo.History.setDefault - defaultHashObj parameter is required")}if(typeof (A)=="string"){this._defaultHash=A}else{if(typeof (A)=="object"){this._defaultHash=this._parseObj(A)}}this._execute()},_execute:function(){var A=this.getHash();if(A.length==0&&this._defaultHash.length>0){A=this._defaultHash}if(this._savedHash!=A){document.title=document.title.replace(window.location.hash,"");this._savedHash=A;this._paramsObj=this._parseHash(this._savedHash);this._topic=this._paramsObj["topic"]||null;this.onChange();if(this._topic){mojo.Messaging.publish(this._topic,this._paramsObj)}}},_parseHash:function(D){var C=new Object();var B=D.split("&");for(var A=0;A<B.length;A++){var E=B[A].split("=");if(E.length==2){C[E[0]]=unescape(E[1])}}return C},_parseObj:function(C){var D=new Array();for(var A in C){D.push(A+"="+escape(C[A].toString()))}var B=D.join("&");return B},getParams:function(){return this._paramsObj},getTopic:function(){return this._topic}});mojo.History.getInstance=function(){if(__mojoHistory==null){__mojoHistory=new mojo.History()}return __mojoHistory};dojo.provide("mojo.*");dojo.provide("mojo.Messaging");__mojoMessagingTopics=new Array();mojo.Messaging.publish=function(B,C){if(B==null||typeof B=="undefined"){throw new Error("ERROR mojo.Messaging.publish - topic parameter is required")}if(!dojo.isString(B)||B==""){throw new Error("ERROR mojo.Messaging.publish - topic parameter must be a non-empty string")}var A=mojo.Messaging.getTopic(B);A.setMessage(C);A.onPublish(C);if(!dojo.isArray(C)){C=[C]}dojo.publish(B,C);A.setMessage(null)};mojo.Messaging.subscribe=function(A,B,C){if(A==null||typeof A=="undefined"){throw new Error("ERROR mojo.Messaging.subscribe - topic parameter is required")}if(!dojo.isString(A)||A==""){throw new Error("ERROR mojo.Messaging.subscribe - topic parameter must be a non-empty string")}if(!dojo.isObject(B)&&!dojo.isString(B)){throw new Error("ERROR mojo.Messaging.subscribe - targetObj parameter must be an object or a string")}mojo.Messaging.getTopic(A);return dojo.subscribe(A,B,C)};mojo.Messaging.unsubscribe=function(A){dojo.unsubscribe(A)};mojo.Messaging.getTopic=function(A){if(A==null||typeof A=="undefined"){throw new Error("ERROR mojo.Messaging.getTopic - topic parameter is required")}if(!dojo.isString(A)||A==""){throw new Error("ERROR mojo.Messaging.getTopic - topic parameter must be a non-empty string")}if(!__mojoMessagingTopics[A]){__mojoMessagingTopics[A]=new mojo.MessagingTopic(A)}return __mojoMessagingTopics[A]};dojo.provide("mojo.MessagingTopic");dojo.declare("mojo.MessagingTopic",null,{onPublish:function(){},constructor:function(A){if(A==null||typeof A=="undefined"){throw new Error("ERROR mojo.MessagingTopic - topic parameter is required")}if(typeof A=="string"){if(A==""){throw new Error("ERROR mojo.MessagingTopic - topic parameter must be a non-empty string")}}else{throw new Error("ERROR mojo.MessagingTopic - topic parameter is not type String")}this._topic=A;__mojoMessagingTopics[A]=this},_topic:null,_messageObj:null,getTopic:function(){return this._topic},getMessage:function(){return this._messageObj},setMessage:function(A){this._messageObj=A}});dojo.provide("mojo.Model");__mojoModel=new Array();__mojoModelReferences=new Array();mojo.Model.set=function(A,B){if(A==null||typeof A=="undefined"){throw new Error("ERROR mojo.Model.set - key parameter is required")}if(!dojo.isString(A)||A==""){throw new Error("ERROR mojo.Model.set - key parameter must be a non-empty string")}__mojoModel[A]=dojo.clone(B);mojo.Model.notify(A)};mojo.Model.add=function(B,D){if(B==null||typeof B=="undefined"){throw new Error("ERROR mojo.Model.add - key parameter is required")}if(!dojo.isString(B)||B==""){throw new Error("ERROR mojo.Model.add - key parameter must be a non-empty string")}if(D==null||typeof D=="undefined"){throw new Error("ERROR mojo.Model.add - valueObj parameter is required")}if(D==""){throw new Error("ERROR mojo.Model.add - valueObj parameter must be a non-empty string")}if(mojo.Model.contains(B)){if(!dojo.isArray(__mojoModel[B])){var C=__mojoModel[B];__mojoModel[B]=new Array();__mojoModel[B].push(C)}if(dojo.isArray(D)){for(var A=0;A<D.length;A++){__mojoModel[B].push(D[A])}}else{__mojoModel[B].push(D)}mojo.Model.notify(B)}else{mojo.Model.set(B,D)}};mojo.Model.get=function(B){if(B==null||typeof B=="undefined"){throw new Error("ERROR mojo.Model.get - key parameter is required")}if(!dojo.isString(B)||B==""){throw new Error("ERROR mojo.Model.get - key parameter must be a non-empty string")}var A=__mojoModel[B];if(typeof A=="undefined"){if(dojo.config&&dojo.config.isDebug){console.debug('WARNING mojo.Model - No entry found for "'+B+'" key')}A=null}return A};mojo.Model.getReference=function(A){if(A==null||typeof A=="undefined"){throw new Error("ERROR mojo.Model.getReference - key parameter is required")}if(!dojo.isString(A)||A==""){throw new Error("ERROR mojo.Model.getReference - key parameter must be a non-empty string")}if(!__mojoModelReferences[A]){__mojoModelReferences[A]=new mojo.ModelReference(A)}return __mojoModelReferences[A]};mojo.Model.remove=function(A){if(A==null||typeof A=="undefined"){throw new Error("ERROR mojo.Model.remove - key parameter is required")}if(!dojo.isString(A)||A==""){throw new Error("ERROR mojo.Model.remove - key parameter must be a non-empty string")}var B=mojo.Model.getReference(A);__mojoModel[A]=null;mojo.Model.notify(A)};mojo.Model.contains=function(B){if(B==null||typeof B=="undefined"){throw new Error("ERROR mojo.Model.contains - key parameter is required")}if(!dojo.isString(B)||B==""){throw new Error("ERROR mojo.Model.contains - key parameter must be a non-empty string")}var A=__mojoModel[B];if(A){return true}return false};mojo.Model.notify=function(C){if(C==null||typeof C=="undefined"){throw new Error("ERROR mojo.Model.notify - key parameter is required")}if(!dojo.isString(C)||C==""){throw new Error("ERROR mojo.Model.notify - key parameter must be a non-empty string")}__mojoModel["__mojoTemplateControllers"]=[];var D=mojo.Model.getReference(C);D.onNotify();mojo.Messaging.publish("/mojo/model/"+C);var E=__mojoModel["__mojoTemplateControllers"].length;for(var B=0;B<E;B++){var A=__mojoModel["__mojoTemplateControllers"][B];if(A&&A.updateController){A._addObservers();A.updateController=null}}__mojoModel["__mojoTemplateControllers"]=null};mojo.Model.addObserver=function(B,A,C){if(B==null||typeof B=="undefined"){throw new Error("ERROR mojo.Model.addObserver - key parameter is required")}if(!dojo.isString(B)||B==""){throw new Error("ERROR mojo.Model.addObserver - key parameter must be a non-empty string")}if(A==null||typeof A=="undefined"){throw new Error("ERROR mojo.Model.addObserver - targetObj parameter is required")}if(!dojo.isObject(A)){throw new Error("ERROR mojo.Model.addObserver - targetObj parameter must be an object")}if(C==null||typeof C=="undefined"){throw new Error("ERROR mojo.Model.addObserver - targetFunc parameter is required")}if(!dojo.isString(C)||C==""){throw new Error("ERROR mojo.Model.addObserver - targetFunc parameter must be a function and is not of type string")}return mojo.Messaging.subscribe("/mojo/model/"+B,A,C)};mojo.Model.removeObserver=function(A){if(A==null||typeof A!="object"){throw new Error("ERROR mojo.Model.removeObserver - handle parameter is required")}mojo.Messaging.unsubscribe(A)};dojo.provide("mojo.ModelReference");dojo.declare("mojo.ModelReference",null,{onNotify:function(){},constructor:function(A){if(A==null||typeof A=="undefined"){throw new Error("ERROR mojo.ModelReference - key parameter is required")}if(!dojo.isString(A)||A==""){throw new Error("ERROR mojo.ModelReference - key parameter must be a non-empty string")}this._key=A;__mojoModelReferences[A]=this},_key:null,getKey:function(){return this._key},getValue:function(){return mojo.Model.get(this._key)},setValue:function(A){mojo.Model.set(this._key,A)}});dojo.provide("mojo.query");mojo.query=function(D,C){if(C&&(typeof C=="string"||typeof C=="object")){var B=dojo.query(D,C)}else{if((new RegExp(/^\#[a-zA-Z0-9\-\_]*$/)).test(D)){var A=document.getElementById(D.substring(1));if(A){var B=[A]}else{var B=[]}}else{var B=dojo.query(D)}}return B};mojo.queryFirst=function(C,B){var A=mojo.query(C,B);if(A.length>0){return A[0]}return null};mojo.distinct=function(E){if(E.length==0){return E}var C=[],F;for(var B=0,A=E.length;B<A;B++){if(!(F=E[B])._counted){F._counted=true;C.push(F)}}for(var B=0,D;D=C[B];B++){D._counted=undefined}return C};mojo.queryMatch=function(B,H,F,C){if(!B||B==F){return null}var G=false;var E=[];if((new RegExp(/^[\#|\.]?[a-zA-Z0-9\-\_]+$/)).test(H)){G=true}else{E=mojo.query(H,F)}while(B&&B!=F){if(G){if((H.indexOf("#")==0&&B.id==H.substring(1))||(H.indexOf(".")==0&&dojo.hasClass(B,H.substring(1)))||(B["tagName"]&&B.tagName.toLowerCase()==H.toLowerCase())){return B}}else{for(var D=0,A=E.length;D<A;D++){if(E[D]==B){return B}}}if(C){B=B.parentNode}else{break}}return null};dojo.provide("mojo.service.Locator");__mojoServiceRegistry=new Array();dojo.declare("mojo.service.Locator",null,{constructor:function(){if(__mojoServiceRegistry.length==0){this.addServices()}},addServices:function(){if(dojo.config&&dojo.config.isDebug){console.debug("ERROR mojo.service.Locator - addServices() not implemented")}},addService:function(A){if(A==null||typeof A=="undefined"){throw (new Error("ERROR mojo.service.Locator.addService - serviceObj parameter is required"))}if(!(A instanceof mojo.service.Service)){throw (new Error("ERROR mojo.service.Locator.addService - serviceObj parameter must be an instance of the mojo.service.Service class"))}var B=A.getName();if(!__mojoServiceRegistry[B]){__mojoServiceRegistry[B]=A}else{throw (new Error('ERROR mojo.service.Locator.addService - service with the name "'+B+'" already exists in the registry; service not added'))}},getService:function(A){if(A==null||typeof A=="undefined"){throw new Error("ERROR mojo.service.Locator.getService - name parameter is required")}if(!dojo.isString(A)||A==""){throw new Error("ERROR mojo.service.Locator.getService - name parameter must be a non-empty string")}return __mojoServiceRegistry[A]||null}});dojo.provide("mojo.service.Service");dojo.declare("mojo.service.Service",null,{VALID_METHODS:["GET","POST","PUT","DELETE"],DEFAULT_PARAMS:{format:"json",method:"GET",cacheExpiry:0,cache:true,retry:1,hijax:false,inferArrays:true},constructor:function(A,B,C){if(A==null||typeof A=="undefined"){throw new Error("ERROR mojo.service.Service.constructor - name parameter is required")}if(!dojo.isString(A)||A==""){throw new Error("ERROR mojo.service.Service.constructor - name parameter must be a non-empty string")}if(B==null||typeof B=="undefined"){throw new Error("ERROR mojo.service.Service.constructor - uri parameter is required")}if(!dojo.isString(B)||B==""){throw new Error("ERROR mojo.service.Service.constructor - uri parameter must be a non-empty string")}var D={};for(property in this.DEFAULT_PARAMS){D[property]=this.DEFAULT_PARAMS[property]}if(A.toLowerCase().indexOf("add")==0){D.method="POST"}else{if(A.toLowerCase().indexOf("update")==0){D.method="PUT"}else{if(A.toLowerCase().indexOf("delete")==0){D.method="DELETE"}}}if(C){if(C.method){if(C.method!="GET"){D.cache=false}}else{if(D.method!="GET"){D.cache=false}}if(C.method){if(C.method!="GET"){D.retry=0}}else{if(D.method!="GET"){D.retry=0}}}if(C){for(property in C){D[property]=C[property]}}this.setName(A);this.setUri(B);this.setParams(D);this._expireCache(this.getName())},_name:"",_uri:"",_params:new Object(),getName:function(){return this._name},setName:function(A){if(A==null||typeof A=="undefined"){throw new Error("ERROR mojo.service.Service.setName - name parameter is required")}if(!dojo.isString(A)||A==""){throw new Error("ERROR mojo.service.Service.setName - name parameter must be a non-empty string")}this._name=A},getUri:function(){return this._uri},setUri:function(A){if(A==null||typeof A=="undefined"){throw new Error("ERROR mojo.service.Service.setUri - uri parameter is required")}if(!dojo.isString(A)||A==""){throw new Error("ERROR mojo.service.Service.setUri - uri parameter must be a non-empty string")}this._uri=A},getParams:function(){return this._paramsObj},setParams:function(D){if(!D){throw new Error("ERROR mojo.service.Service.setParams - paramsObj parameter is required")}if(D){for(property in D){switch(property){case"hijax":case"cache":case"inferArrays":if(typeof D[property]!="boolean"){throw new Error("ERROR mojo.service.Service.setParams - "+property+" property of paramsObj must be a boolean")}break;case"cacheExpiry":case"retry":if(typeof D[property]!="number"){throw new Error("ERROR mojo.service.Service.setParams - "+property+" property of paramsObj must be a number")}break;case"format":if(typeof D[property]!="string"){throw new Error("ERROR mojo.service.Service.setParams - "+property+" property of paramsObj must be a string")}break;case"method":var B=false;for(var C=0,A=this.VALID_METHODS.length;C<A;C++){if(this.VALID_METHODS[C]==D[property].toUpperCase()){B=true}}if(!B){throw new Error('ERROR mojo.service.Service.setParams - method property of paramsObj must be one of "GET", "POST", "PUT", or "DELETE"')}break}}}if(!this._paramsObj){this._paramsObj={}}if(D.json==true){this._paramsObj.format="json";if(dojo.config&&dojo.config.isDebug){console.debug("WARNING mojo.service.Service.setParams - json parameter is DEPRECATED; use {format: 'json'} instead")}}if(D.json==false){this._paramsObj.format="text";if(dojo.config&&dojo.config.isDebug){console.debug("WARNING mojo.service.Service.setParams - json parameter is DEPRECATED; use {format: 'json'} instead")}}for(property in D){this._paramsObj[property]=D[property]}},invoke:function(paramsObj,callerObj){if(!callerObj){throw new Error("ERROR mojo.service.Service.invoke - callerObj parameter is required")}if(!dojo.isObject(callerObj)){throw new Error("ERROR mojo.service.Service.invoke - callerObj parameter must be an object")}if(typeof callerObj.onResponse!="function"){throw new Error("ERROR mojo.service.Service.invoke - callerObj parameter must contain an object with an onResponse method")}if(typeof callerObj.onError!="function"){throw new Error("ERROR mojo.service.Service.invoke - callerObj parameter must contain an object with an onError method")}var serviceParams=this.getParams();if(typeof TrimPath!="undefined"&&TrimPath.parseTemplate){var uriFinal=TrimPath.parseTemplate(this.getUri()).process(paramsObj);if(paramsObj&&paramsObj["_MODIFIERS"]&&paramsObj["defined"]){delete paramsObj["_MODIFIERS"];delete paramsObj["defined"]}}else{var uriFinal=this.getUri()}if(serviceParams.hijax&&callerObj.getRequest()&&callerObj.getRequest().callerObj&&callerObj.getRequest().callerObj.tagName=="A"){uriFinal=callerObj.getRequest().callerObj.href}var tried=0;var serializeName=this.getName();var pairs=new Array();for(var key in paramsObj){if(typeof (paramsObj[key])!="function"){pairs.push(key+"_"+paramsObj[key])}else{pairs.push(key+"__function")}}if(pairs.length>0){serializeName+="_"+pairs.join("_")}var errorCallback=function(errorObj,httpObj){var errors=new Array();if(httpObj){errorObj.code=httpObj.status;errors.push(errorObj)}if(typeof (errorObj)=="string"){var msg=errorObj;errorObj=new Object();errorObj.message=msg}if(errorObj.name){errorObj.code=errorObj.name;errors.push(errorObj)}if(errorObj.errors){errors=errorObj.errors}if(errorObj.error){errors.push(errorObj.error)}if(errors[0]["redirectUrl"]){window.location.replace(errors[0]["redirectUrl"])}if(httpObj&&serviceParams.retry>=tried){serviceInvoke()}else{callerObj.onError(errors)}};var thisObj=this;var serviceInvoke=function(){var toSentenceCase=function(string){return string.charAt(0).toUpperCase()+string.replace(/ \w/g,function(m){return m.toUpperCase()}).substring(1)};return dojo["xhr"+toSentenceCase(serviceParams.method.toLowerCase())]({url:uriFinal,preventCache:(!serviceParams.cache&&serviceParams.method=="GET"),handleAs:serviceParams.format,content:paramsObj,load:function(response,ioArgs){tried++;if(ioArgs.handleAs=="json"){if(!dojo.isObject(response)){try{response=eval(response)}catch(ex){errorCallback(ex);return }}if(response.error||response.errors){errorCallback(response)}else{if(serviceParams.cache){thisObj._setCache(serializeName,response,serviceParams.cacheExpiry)}callerObj.onResponse(response,ioArgs.args.content)}}else{if(ioArgs.handleAs=="xml"){try{var params={};if(typeof serviceParams.inferArrays!="undefined"){params.inferArrays=serviceParams.inferArrays}response=mojo.helper.XML.toObject(response,params)}catch(ex){errorCallback(ex)}if(response.error||response.errors){if(response.errors&&response.errors["error"]&&response.errors["error"] instanceof Array){response.errors=response.errors["error"]}errorCallback(response)}else{if(serviceParams.cache){thisObj._setCache(serializeName,response,serviceParams.cacheExpiry)}callerObj.onResponse(response,ioArgs.args.content)}}else{if(serviceParams.cache){thisObj._setCache(serializeName,response,serviceParams.cacheExpiry)}callerObj.onResponse(response,ioArgs.args.content)}}},error:function(response,ioArgs){tried++;errorCallback(response,ioArgs.xhr)}})};var cacheObj;if(serviceParams.cache){cacheObj=this._getCache(serializeName)}if(cacheObj){callerObj.onResponse(cacheObj.data,paramsObj)}else{var currentXhr=serviceInvoke()}return currentXhr},_setCache:function(A,D,C){var B=0;if(C>0){B=(new Date()).getTime()+(C*1000)}mojo.Model.set(A,{data:D,expiryTime:B})},_getCache:function(C){var A=null;if(mojo.Model.contains(C)){A=mojo.Model.get(C);var B=(new Date()).getTime();if(A.expiryTime>0&&B>A.expiryTime){this._expireCache(C);A=null}}return A},_expireCache:function(A){mojo.Model.remove(A)}})